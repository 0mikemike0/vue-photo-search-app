(function(t){function e(e){for(var i,r,o=e[0],c=e[1],u=e[2],m=0,g=[];m<o.length;m++)r=o[m],Object.prototype.hasOwnProperty.call(n,r)&&n[r]&&g.push(n[r][0]),n[r]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(t[i]=c[i]);l&&l(e);while(g.length)g.shift()();return s.push.apply(s,u||[]),a()}function a(){for(var t,e=0;e<s.length;e++){for(var a=s[e],i=!0,o=1;o<a.length;o++){var c=a[o];0!==n[c]&&(i=!1)}i&&(s.splice(e--,1),t=r(r.s=a[0]))}return t}var i={},n={app:0},s=[];function r(e){if(i[e])return i[e].exports;var a=i[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=t,r.c=i,r.d=function(t,e,a){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(a,i,function(e){return t[e]}.bind(null,i));return a},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/vue-photo-search-app/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=e,o=o.slice();for(var u=0;u<o.length;u++)e(o[u]);var l=c;s.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"00ea":function(t,e,a){},2843:function(t,e,a){"use strict";var i=a("fc70"),n=a.n(i);n.a},2885:function(t,e,a){"use strict";var i=a("e328"),n=a.n(i);n.a},"425b":function(t,e,a){},"56d7":function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d");var i=a("2b0e"),n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"hero is-light is-fullheight"},[a("header",[a("nav",{staticClass:"navbar has-background-warning is-fixed-top",attrs:{role:"navigation","aria-label":"main navigation"}},[a("MarkIndicator"),a("ImageFilter")],1)]),a("main",{staticClass:"hero-body mt-6 pt-6 is-light"},[a("router-view")],1),t._m(0)])},s=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("footer",{staticClass:"footer"},[a("div",{staticClass:"content has-text-centered"},[a("p",[t._v(" Photos provided "),a("a",{attrs:{href:"https://www.pexels.com"}},[t._v("by Pexels")])])])])}],r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("router-link",{staticClass:"goto-main is-text px-5",attrs:{to:{name:"main"}}},[a("span",{staticClass:"icon has-text-danger px-4"},[a("i",{staticClass:"fa fa-lg fa-heart",attrs:{"aria-hidden":"true"}})]),a("span",{staticClass:"marked-amount"},[t._v(t._s(t.$store.state.markedImages.length))])])},o=[],c={},u=c,l=(a("6ba3"),a("2877")),m=Object(l["a"])(u,r,o,!1,null,"d6fccf02",null),g=m.exports,d=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"field navbar-item"},[a("button",{staticClass:"delete is-small",on:{click:function(e){return e.preventDefault(),t.clear()}}}),a("p",{staticClass:"control"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.currentQuery,expression:"currentQuery"}],staticClass:"input search-input",attrs:{type:"text",placeholder:"что ищем?"},domProps:{value:t.currentQuery},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search()},input:function(e){e.target.composing||(t.currentQuery=e.target.value)}}})]),a("button",{staticClass:"button search-button is-primary",attrs:{type:"submit"},on:{click:function(e){return e.preventDefault(),t.search()}}},[t._v("Найти")])])},p=[],f=(a("b0c0"),{data:function(){return{currentQuery:""}},watch:{"$route.path":{handler:function(){"main"===this.$route.name&&this.clear()}}},methods:{search:function(){this.$route.path==="/search/".concat(this.currentQuery)?this.$store.dispatch("loadImages",this.currentQuery):(this.$store.dispatch("loadImages",this.currentQuery),this.$router.push({name:"query",params:{query:this.currentQuery}}));var t=document.querySelector(".search-button");t.focus(),window.scrollTo(this.pageXOffset,0)},clear:function(){this.currentQuery="";var t=document.querySelector(".search-input");t.focus()}}}),h=f,v=(a("5a86"),Object(l["a"])(h,d,p,!1,null,"6e9fcf36",null)),y=v.exports,b={components:{MarkIndicator:g,ImageFilter:y},created:function(){this.$store.commit("updateMarkImages")}},x=b,_=(a("cdbc"),Object(l["a"])(x,n,s,!1,null,"2e52b1d6",null)),k=_.exports,P=a("8c4f"),I=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container has-text-centered"},[a("ImagesList",{attrs:{images:t.images}}),0==t.$store.state.markedImages?a("div",{staticClass:"notification is-danger"},[t._v("Ни одно фото не отмечено.")]):t._e(),a("BasePagination",{attrs:{count:t.markImages.length,"per-page":t.imagesPerPage},model:{value:t.page,callback:function(e){t.page=e},expression:"page"}})],1)},C=[],q=(a("fb6a"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("nav",{staticClass:"pagination is-rounded is-centered mt-3",attrs:{role:"navigation","aria-label":"pagination"}},[t.count?a("a",{staticClass:"pagination-previous",attrs:{disabled:t.isPrevButtonDisabled},on:{click:function(e){return e.preventDefault(),t.paginatePrev(t.page)}}},[t._m(0)]):t._e(),t.count?a("a",{staticClass:"pagination-next",attrs:{disabled:t.isNextButtonDisabled},on:{click:function(e){return e.preventDefault(),t.paginateNext(t.page)}}},[t._m(1)]):t._e(),a("ul",{staticClass:"pagination-list"},t._l(t.pagesAmount,(function(e){return a("li",{key:e},[a("a",{staticClass:"pagination-link",class:{"is-current":e===t.page},attrs:{"aria-label":"Goto page pageNumber"},on:{click:function(a){return t.paginate(e)}}},[t._v(t._s(e))])])})),0)])}),$=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{staticClass:"icon has-text-primary"},[a("i",{staticClass:"fas fa-arrow-left"})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{staticClass:"icon has-text-primary"},[a("i",{staticClass:"fas fa-arrow-right"})])}],O={model:{prop:"page",event:"paginate"},props:["page","count","perPage"],computed:{pagesAmount:function(){return Math.ceil(this.count/this.perPage)},isPrevButtonDisabled:function(){return 1===this.page},isNextButtonDisabled:function(){return this.page===this.pagesAmount}},methods:{paginate:function(t){this.$emit("paginate",t)},paginateNext:function(t){t!==this.pagesAmount&&this.$emit("paginate",t+1)},paginatePrev:function(t){1!==t&&this.$emit("paginate",t-1)}}},w=O,F=(a("2885"),Object(l["a"])(w,q,$,!1,null,"c1e667d0",null)),j=F.exports,D=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ul",{},t._l(t.images,(function(e){return a("li",{key:e.id,staticClass:"image"},[a("router-link",{attrs:{to:{name:"image",params:{id:e.id}}}},[a("img",{attrs:{src:e.src.tiny,alt:"взять из input"}})]),a("p",{staticClass:"is-size-6"},[a("a",{attrs:{href:e.photographer_url}},[t._v(t._s(e.photographer))])])],1)})),0)},M=[],Q={props:["images"]},L=Q,N=(a("2843"),Object(l["a"])(L,D,M,!1,null,"773d2af5",null)),T=N.exports,S=a("bc3a"),E=a.n(S),A={data:function(){return{page:1,imagesPerPage:3,markImages:[]}},computed:{images:function(){var t=(this.page-1)*this.imagesPerPage;return this.markImages?this.markImages.slice(t,t+this.imagesPerPage):[]}},components:{BasePagination:j,ImagesList:T},methods:{loadMarkedImages:function(){for(var t=this,e=E.a.create({baseURL:"https://api.pexels.com/v1",crossDomain:!0,responseType:"json",headers:{Authorization:"563492ad6f91700001000001c6bcce7f3549472d9f001e36d532ad09"}}),a=0;a<this.$store.state.markedImages.length;a+=1)e.get("https://api.pexels.com/v1/photos/".concat(this.$store.state.markedImages[a])).then((function(e){return t.markImages.push(e.data)}))}},created:function(){this.loadMarkedImages()}},B=A,z=Object(l["a"])(B,I,C,!1,null,null,null),J=z.exports,R=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container has-text-centered "},[a("article",{staticClass:"media pt-1"},[a("div",{staticClass:"media-content"},[a("div",{staticClass:"content"},[t.image.src?a("picture",{staticClass:"is-centered"},[a("source",{attrs:{media:"(max-width: 799px)",srcset:t.image.src.portrait}}),a("source",{attrs:{media:"(min-width: 800px)",srcset:t.image.src.landscape}}),a("img",{attrs:{src:t.image.src.large,alt:t.Photo}})]):t._e(),a("nav",{staticClass:"level is-mobile"},[a("a",{staticClass:"level-item"},[a("span",{staticClass:"icon is-large is-primary",class:{"has-text-danger":-1!==t.imageMark},on:{click:function(e){return t.changeMark(t.imageMark)}}},[a("i",{staticClass:"fas fa-heart"})])])])])]),a("div",{staticClass:"media-right"},[a("button",{staticClass:"delete",on:{click:function(e){return e.preventDefault(),t.goBack()}}})])])])},U=[],X=(a("c975"),{data:function(){return{imageData:{}}},computed:{image:function(){return this.imageData?this.imageData:{}},imageMark:function(){return this.$store.state.markedImages.indexOf(this.image.id)}},methods:{loadImage:function(){var t=this;clearTimeout(this.loadImagesTimer),this.loadImagesTimer=setTimeout((function(){var e=E.a.create({baseURL:"https://api.pexels.com/v1",crossDomain:!0,responseType:"json",headers:{Authorization:"563492ad6f91700001000001c6bcce7f3549472d9f001e36d532ad09"}});e.get("https://api.pexels.com/v1/photos/".concat(t.$route.params.id)).then((function(e){t.imageData=e.data}))}),0)},changeMark:function(t){-1===t?this.$store.commit("addMarkToImage",this.image.id):this.$store.commit("removeMarkFromImage",this.imageMark)},goBack:function(){this.$router.back()}},watch:{"$route.params.id":{handler:function(){this.loadImage()},immediate:!0}}}),G=X,H=Object(l["a"])(G,R,U,!1,null,null,null),K=H.exports,V=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container has-text-centered",attrs:{tabindex:"-1"}},[t.loading?a("div",{staticClass:"notification is-danger"},[t._v("Загружаем...")]):t.total?a("div",[t._v("Всего фото найдено: "+t._s(t.total))]):a("div",{staticClass:"notification is-danger"},[t._v("Фото не найдено. Попробуйте ещё раз.")]),t.images?a("ImagesList",{attrs:{images:t.images}}):t._e(),t.total?a("button",{staticClass:"button is-primary is-centered mt-4",attrs:{type:"button",disabled:!t.nextPage},on:{click:function(e){return t.gotoNextPage()}}},[t._v("NEXT")]):t._e(),t.addingFail?a("div",{staticClass:"notification is-danger mt-4"},[t._v("Сервер не отвечает. Попробуйте ещё раз.")]):t._e()],1)},W=[],Y=a("5530"),Z=a("2f62"),tt={components:{ImagesList:T},computed:Object(Y["a"])(Object(Y["a"])({},Object(Z["b"])(["getPhotos","getFails"])),{},{imagesData:function(){return this.getPhotos(this.query)?this.getPhotos(this.query):null},images:function(){return this.imagesData?this.imagesData.photos:[]},total:function(){return this.imagesData?this.imagesData.total:0},nextPage:function(){return this.imagesData?this.imagesData.nextPage:0},loading:function(){return this.getFails.loading},loadingFail:function(){return this.getFails.loadingFail},addingFail:function(){return this.getFails.addingFail},query:function(){return this.$route.params.query}}),methods:{gotoNextPage:function(){this.$store.dispatch("gotoNextPage",this.$route.params.query)}},created:function(){this.imagesData||this.$store.dispatch("loadImages",this.$route.params.query)}},et=tt,at=Object(l["a"])(et,V,W,!1,null,null,null),it=at.exports;i["a"].use(P["a"]);var nt=[{name:"main",component:J,path:"/"},{name:"query",component:it,path:"/search/:query"},{name:"image",component:K,path:"/image/:id"}],st=new P["a"]({routes:nt}),rt=st,ot=(a("99af"),a("a434"),a("2909"));i["a"].use(Z["a"]);var ct=new Z["a"].Store({state:{markedImages:[],queries:{imagesPerPage:18},fails:{loadingFail:!1,addingFail:!1,loading:!1}},mutations:{addMarkToImage:function(t,e){t.markedImages.push(e),localStorage.markedImages=JSON.stringify(t.markedImages)},removeMarkFromImage:function(t,e){t.markedImages.splice(e,1),localStorage.markedImages=JSON.stringify(t.markedImages)},updateMarkImages:function(t){localStorage.markedImages&&(t.markedImages=JSON.parse(localStorage.markedImages))},createQueryImages:function(t,e){i["a"].set(t.queries,e.query,{}),i["a"].set(t.queries[e.query],"photos",e.photos),i["a"].set(t.queries[e.query],"total",e.total),i["a"].set(t.queries[e.query],"nextPage",e.nextPage)},updateQueryImages:function(t,e){t.queries[e.query].photos=e.photos},addQueryImages:function(t,e){var a;(a=t.queries[e.query].photos).splice.apply(a,[t.queries[e.query].photos.length,0].concat(Object(ot["a"])(e.photos)))},updateQueryTotal:function(t,e){t.queries[e.query].total=e.total},updateQueryNextPage:function(t,e){t.queries[e.query].nextPage=e.nextPage},updateQueryPosition:function(t,e){t.queries[e.query].position=e.position},updateLoadingFail:function(t){t.fails.loadingFail=!0},updateAddingFail:function(t){t.fails.addingFail=!0},updateLoading:function(t){t.fails.loading=!0},clearLoadingFail:function(t){t.fails.loadingFail=!1},clearAddingFail:function(t){t.fails.addingFail=!1},clearLoading:function(t){t.fails.loading=!1}},getters:{getPhotos:function(t){return function(e){return t.queries[e]}},getFails:function(t){return t.fails}},actions:{loadImages:function(t,e){t.commit("clearLoadingFail"),t.commit("updateLoading");var a=E.a.create({baseURL:"https://api.pexels.com/v1",crossDomain:!0,responseType:"json",headers:{Authorization:"563492ad6f91700001000001c6bcce7f3549472d9f001e36d532ad09"}});a.get("https://api.pexels.com/v1/search/",{params:{per_page:this.state.queries.imagesPerPage,query:e}}).then((function(a){t.state.queries[e]?t.commit("updateQueryImages",{query:e,photos:a.data.photos,total:a.data.total_results,nextPage:a.data.next_page}):t.commit("createQueryImages",{query:e,photos:a.data.photos,total:a.data.total_results,nextPage:a.data.next_page})})).catch((function(){return t.commit("updateLoadingFail")})).then((function(){return t.commit("clearLoading")}))},gotoNextPage:function(t,e){t.commit("clearAddingFail");var a=E.a.create({baseURL:"https://api.pexels.com/v1",crossDomain:!0,responseType:"json",headers:{Authorization:"563492ad6f91700001000001c6bcce7f3549472d9f001e36d532ad09"}});a.get("".concat(t.state.queries[e].nextPage)).catch((function(){return t.commit("updateAddingFail")})).then((function(a){t.commit("addQueryImages",{query:e,photos:a.data.photos}),t.commit("updateQueryNextPage",{query:e,nextPage:a.data.next_page})}))}}});i["a"].config.productionTip=!1,new i["a"]({router:rt,store:ct,render:function(t){return t(k)}}).$mount("#app")},"5a86":function(t,e,a){"use strict";var i=a("93c3"),n=a.n(i);n.a},"6ba3":function(t,e,a){"use strict";var i=a("00ea"),n=a.n(i);n.a},"93c3":function(t,e,a){},cdbc:function(t,e,a){"use strict";var i=a("425b"),n=a.n(i);n.a},e328:function(t,e,a){},fc70:function(t,e,a){}});
//# sourceMappingURL=app.deb9d4c9.js.map